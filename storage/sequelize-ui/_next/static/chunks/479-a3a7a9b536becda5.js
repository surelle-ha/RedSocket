"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[479],{1479:function(e,t,n){n.r(t),n.d(t,{SequelizeFramework:function(){return eM}});var a,o,r,c=n(8324);function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t.split("\n").map(t=>n+" ".repeat(e)+t).join("\n")}(o||(o={})).Npm="NPM";let l={separator:"",depth:0};function i(e){let{separator:t="",depth:n=0,prefix:a=""}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;return s(n,(function e(t){let n=[];for(let a of t)Array.isArray(a)?n.push(...e(a)):n.push(a);return n})(e).filter(e=>null!==e).filter((e,t,n)=>!function(e,t){let n=e[t-1],a=e[t];return void 0!==n&&void 0!==a&&u(n)&&u(a)}(n,t)).join("".concat(t,"\n")),a)}function u(e){return"string"==typeof e&&""===e.trim()}var d=n(7803),p=n(8755),m=n(7001),f=n(9054),y=n(9858);function M(e){let{env:t,schema:n,dbOptions:a,fallback:o}=e;return i(["".concat(t,": {"),i([g(a.sqlDialect),A(a.sqlDialect,o),T(n.name,a.sqlDialect,o),b(a.sqlDialect,o),S(a.sqlDialect,o),q(a.sqlDialect,o),x(a.sqlDialect,o)],{depth:2,separator:","}),"}"])}let g=e=>"dialect: '".concat(function(e){switch(e){case d.t5.MariaDb:return"mariadb";case d.t5.MsSql:return"mssql";case d.t5.MySql:return"mysql";case d.t5.Postgres:return"postgres";case d.t5.Sqlite:return"sqlite"}}(e),"'"),h=(e,t)=>t?" || ".concat(e):"",A=(e,t)=>{let n=(0,d.Vf)(e);return n?"storage: process.env.".concat((0,d.oQ)(e)).concat(h("'".concat(n,"'"),t)):null},T=(e,t,n)=>{let a=(0,d.p$)(e,t);return a?"database: process.env.".concat((0,d.oQ)(t),"_DB_NAME").concat(h("'".concat(a,"'"),n)):null},b=(e,t)=>{let n=(0,d.uV)(e);return n?"username: process.env.".concat((0,d.oQ)(e),"_DB_USERNAME").concat(h("'".concat(n,"'"),t)):null},S=(e,t)=>{let n=(0,d.dv)(e);return n?"password: process.env.".concat((0,d.oQ)(e),"_DB_PASSWORD").concat(h("'".concat(n,"'"),t)):null},q=(e,t)=>{let n=(0,d.dm)(e);return n?"host: process.env.".concat((0,d.oQ)(e),"_DB_HOST").concat(h("'".concat(n,"'"),t)):null},x=(e,t)=>{let n=(0,d.hX)(e);return n?"port: parseInt(process.env.".concat((0,d.oQ)(e),"_DB_PORT").concat(h("'".concat(n,"'"),t),")"):null},U=()=>i(["import { Sequelize, Options } from 'sequelize'","import configs from './config/config.js'","","const env = process.env.NODE_ENV || 'development'","const config = (configs as {[key: string]: Options})[env]"]),B=e=>{let{dbOptions:t}=e;return i(["const db: Sequelize = new Sequelize({",i(["...config",I(t)],{separator:",",depth:2}),"})"])},v=()=>"export default db",D=e=>!e.timestamps||e.caseStyle===d.eB.Snake||e.nounForm===d.Bb.Singular,I=e=>D(e)?i(["define: {",i([H(e),N(e.caseStyle===d.eB.Snake),E(e.timestamps)],{separator:",",depth:2}),"}"]):null,N=e=>e?"underscored: true":null,E=e=>e?null:"timestamps: false",H=e=>{let{caseStyle:t,nounForm:n}=e;return t===d.eB.Camel&&n===d.Bb.Singular?"freezeTableName: true":null};function w(e){let{name:t}=e;return(0,y.hP)((0,y.Ho)(t))}function O(e){return"".concat(w(e),".ts")}function C(e){let{association:t,targetModel:n}=e,a=t.alias?t.alias:w(n);return(0,p.lU)(t.type)?(0,y.eV)((0,y.hP)(a)):(0,y.eV)((0,y.we)(a))}function z(e){let{model:t,association:n,modelById:a,dbOptions:o}=e;if(n.foreignKey)return(0,d.x)(n.foreignKey,o.caseStyle);let r=a.get(n.targetModelId),c=n.alias&&n.type.type===p.Nl.BelongsTo?n.alias:n.type.type===p.Nl.BelongsTo&&r?r.name:t.name;return(0,d.x)("".concat(c," id"),o.caseStyle)}function P(e){let{association:t,modelById:n,dbOptions:a}=e,o=n.get(t.targetModelId);if(!o||t.type.type!==p.Nl.ManyToMany)return null;if(t.type.targetFk)return(0,d.x)(t.type.targetFk,a.caseStyle);let r=t.alias?t.alias:o.name;return(0,d.x)("".concat(r," id"),a.caseStyle)}function j(e){let t=w(e);return"import { ".concat(t," } from './").concat(t,"'")}function R(e){let{name:t}=e;return"".concat((0,y.hP)((0,y.Ho)(t)),".initModel(sequelize)")}function V(e){switch(e.type){case p.Us.String:case p.Us.Text:case p.Us.CiText:case p.Us.Uuid:case p.Us.Time:case p.Us.Date:return"string";case p.Us.DateTime:return"Date";case p.Us.Integer:case p.Us.BigInt:case p.Us.SmallInt:case p.Us.Float:case p.Us.Real:case p.Us.Double:case p.Us.Decimal:return"number";case p.Us.Boolean:return"boolean";case p.Us.Enum:return e.values.length>0?e.values.map(e=>"'".concat(e,"'")).join(" | "):"never";case p.Us.Array:if(e.arrayType.type===p.Us.Enum)return"Array<".concat(V(e.arrayType),">");return"".concat(V(e.arrayType),"[]");case p.Us.Json:case p.Us.JsonB:return"Json";case p.Us.Blob:return"Buffer"}}let k=[p.Us.Array,p.Us.JsonB,p.Us.CiText],L=[p.Us.Json];function J(e,t){return!!(t===d.t5.MsSql&&L.includes(e.type)||t!==d.t5.Postgres&&k.includes(e.type))}function F(e){return"".concat("DataTypes.".concat(function(e){switch(e.type){case p.Us.String:return"STRING";case p.Us.Text:return"TEXT";case p.Us.CiText:return"CITEXT";case p.Us.Integer:return"INTEGER";case p.Us.BigInt:return"BIGINT";case p.Us.SmallInt:return"SMALLINT";case p.Us.Float:return"FLOAT";case p.Us.Real:return"REAL";case p.Us.Double:return"DOUBLE";case p.Us.Decimal:return"DECIMAL";case p.Us.DateTime:return"DATE";case p.Us.Date:return"DATEONLY";case p.Us.Time:return"TIME";case p.Us.Boolean:return"BOOLEAN";case p.Us.Enum:return"ENUM";case p.Us.Array:return"ARRAY";case p.Us.Json:return"JSON";case p.Us.JsonB:return"JSONB";case p.Us.Blob:return"BLOB";case p.Us.Uuid:return"UUID"}}(e))).concat((0,p.cb)(e)?e.length?"(".concat(e.length,")"):"":(0,p.FV)(e)?function(e){let{precision:t}=e,n=t?"(".concat(t.precision).concat(t.scale?", ".concat(t.scale):"",")"):"";return"".concat(n).concat(_(e))}(e):(0,p.l7)(e)?_(e):e.type===p.Us.Enum?"(".concat(e.values.map(e=>"'".concat(e,"'")).join(", "),")"):e.type===p.Us.Array?"(".concat(F(e.arrayType),")"):"")}function _(e){return e.unsigned?".UNSIGNED":""}function G(e){return e.fields.some(e=>(0,p.Eb)(e.type))}function K(e,t){return J(e,t)?"// ":""}function Q(e,t){if(!J(e,t))return null;let n=F(e);return"//// ".concat(n," not supported for ").concat((0,d.X6)(t))}function $(e){let{field:t,dbOptions:n,define:a,migration:o}=e,r=K(t.type,n.sqlDialect);return i([Q(t.type,n.sqlDialect),"".concat(r).concat((0,y.eV)(t.name),": {"),i(function(e){let{field:{name:t,type:n,required:a,primaryKey:o,unique:r},define:c,dbOptions:{sqlDialect:s,caseStyle:l},migration:i}=e;return["type: ".concat(F(n)),c?"field: '".concat((0,d.x)(t,l),"'"):null,o?"primaryKey: true":null,(0,p.YF)(n)&&n.autoincrement?"autoIncrement: ".concat(n.autoincrement):null,a?"allowNull: ".concat(!a):null,r?"unique: true":null,function(e,t,n){let a=function(e,t,n){switch(e.type){case p.Us.String:case p.Us.Text:case p.Us.CiText:case p.Us.Enum:return null!=e.defaultValue?"'".concat(e.defaultValue,"'"):null;case p.Us.Integer:case p.Us.BigInt:case p.Us.SmallInt:case p.Us.Float:case p.Us.Real:case p.Us.Double:case p.Us.Decimal:return null!=e.defaultValue?"".concat(e.defaultValue):null;case p.Us.Array:return e.defaultEmptyArray?"[]":null;case p.Us.Date:case p.Us.DateTime:case p.Us.Time:if(!e.defaultNow)return null;if(n){let n=(0,d.T9)(t,function(e){switch(e.type){case p.Us.DateTime:return d.CH.DateTime;case p.Us.Date:return d.CH.Date;case p.Us.Time:return d.CH.Time}}(e)),a=n.type===d.bq.Literal?"literal":"fn";return"Sequelize.".concat(a,"('").concat(n.value,"')")}return"DataTypes.NOW";case p.Us.Uuid:return e.defaultVersion?function(e){switch(e){case p.fO.V1:return"DataTypes.UUIDV1";case p.fO.V4:return"DataTypes.UUIDV4"}}(e.defaultVersion):null;case p.Us.Boolean:return null!=e.defaultValue?"".concat(e.defaultValue):null;case p.Us.Json:case p.Us.JsonB:switch(e.defaultValue){case p.pd.EmptyArray:return"[]";case p.pd.EmptyObject:return"{}";default:return null}case p.Us.Blob:return null}}(e,t,n);return a?"defaultValue: ".concat(a):null}(n,s,i)]}({field:t,dbOptions:n,define:null!=a&&a,migration:null!=o&&o}),{depth:2,separator:",",prefix:r}),"".concat(r,"}")])}function X(e){let{field:t,model:n,dbOptions:a}=e;if(null===a.prefixPks||!t.primaryKey)return t;let o=(0,y.fu)(t.name);return"id"===o||o===(0,y.fu)("".concat(n.name,"_id"))?{...t,name:W({model:n,dbOptions:a})}:t}function Y(e){let{model:t,dbOptions:n}=e;return{...(0,p.EP)({name:W({model:t,dbOptions:n}),type:(0,p.XF)({autoincrement:!0,unsigned:!0}),primaryKey:!0,required:!0}),generated:!0}}function W(e){let{model:t,dbOptions:n}=e;return n.prefixPks?(0,d.x)("".concat(t.name," id"),n.caseStyle):"id"}function Z(e){let{model:t,dbOptions:n}=e;return[n.timestamps?(0,p.EP)({name:(0,d.x)("created at",n.caseStyle),type:(0,p.gt)()}):null,n.timestamps?(0,p.EP)({name:(0,d.x)("updated at",n.caseStyle),type:(0,p.gt)()}):null,t.softDelete?(0,p.EP)({name:(0,d.x)("deleted at",n.caseStyle),type:(0,p.gt)()}):null].filter(e=>!!e)}function ee(e){let{model:t,dbOptions:n}=e,a=(0,d.u$)(t.name,n.caseStyle);return(0,d.Z0)(a,n.nounForm)}(a=r||(r={})).String="STRING",a.Text="TEXT",a.CiText="CITEXT",a.Integer="INTEGER",a.BigInt="BIGINT",a.SmallInt="SMALLINT",a.Float="FLOAT",a.Real="REAL",a.Double="DOUBLE",a.Decimal="DECIMAL",a.Date="DATE",a.Dateonly="DATEONLY",a.Time="TIME",a.Boolean="BOOLEAN",a.Enum="ENUM",a.Array="ARRAY",a.Json="JSON",a.JsonB="JSONB",a.Blob="BLOB",a.Uuid="UUID";let et=i(["BelongsToGetAssociationMixin,","BelongsToSetAssociationMixin,","BelongsToCreateAssociationMixin,"]),en=i(["HasManyGetAssociationsMixin,","HasManySetAssociationsMixin,","HasManyAddAssociationMixin,","HasManyAddAssociationsMixin,","HasManyCreateAssociationMixin,","HasManyRemoveAssociationMixin,","HasManyRemoveAssociationsMixin,","HasManyHasAssociationMixin,","HasManyHasAssociationsMixin,","HasManyCountAssociationsMixin,"]),ea=i(["HasOneGetAssociationMixin,","HasOneSetAssociationMixin,","HasOneCreateAssociationMixin,"]),eo=i(["BelongsToManyGetAssociationsMixin,","BelongsToManySetAssociationsMixin,","BelongsToManyAddAssociationMixin,","BelongsToManyAddAssociationsMixin,","BelongsToManyCreateAssociationMixin,","BelongsToManyRemoveAssociationMixin,","BelongsToManyRemoveAssociationsMixin,","BelongsToManyHasAssociationMixin,","BelongsToManyHasAssociationsMixin,","BelongsToManyCountAssociationsMixin,"]);function er(e){let[t,n]=e;return"import type { ".concat(n.join(", ")," } from './").concat(t,"'")}let ec=(e,t,n)=>{let{name:a,type:o,required:r}=e,c=K(o,t.sqlDialect),s=V(o);return[Q(o,t.sqlDialect),"".concat(c,"declare ").concat((0,y.eV)(a),": ").concat(n?"CreationOptional<".concat(s,">"):r?s:"".concat(s," | null"))]};function es(e){let{alias:t}=e;return t?" (as ".concat((0,y.Ho)(t),")"):""}let el=()=>[["sequelize","^6.37.1"]];function ei(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i(t.slice().sort((e,t)=>{let[n]=e,[a]=t;return n.localeCompare(a)}).map(eu),{separator:",",depth:4})}function eu(e){let[t,n]=e;return'"'.concat(t,'": "').concat(n,'"')}let ed=[d.t5.MariaDb,d.t5.MsSql,d.t5.MySql,d.t5.Postgres],ep=e=>{let{dbOptions:t}=e;return i(["import http from 'http'","import db from './db'","import { initModels } from './models'","",function(e){let{dbOptions:t}=e;return i(["async function run() {",i(["initModels(db)",t.migrations?null:"await db.sync()","const hostname = process.env.HOSTNAME || '127.0.0.1'","const port = parseInt(process.env.PORT || '3000')","","const server = http.createServer((req, res) => {",i(["res.statusCode = 200","res.setHeader('Content-Type', 'text/plain')","res.end('Hello World')"],{depth:2}),"})","","server.listen(port, hostname, () => {",i(["console.log(`Server running at http://${hostname}:${port}/`)"],{depth:2}),"})"],{depth:2}),"}"])}({dbOptions:t}),"","run()"])};function em(e){let{model:t,fk:n,dbOptions:a,primaryKey:o=!1}=e,r=t.fields.find(e=>e.primaryKey)||Y({model:t,dbOptions:a}),c=ee({model:t,dbOptions:a}),s=X({field:r,model:t,dbOptions:a}),l=(0,d.x)(s.name,a.caseStyle);return{...(0,p.EP)({name:n,type:(0,p.Tk)(r.type),primaryKey:o}),reference:{table:c,column:l}}}let ef=e=>{let{schema:t,dbOptions:n}=e;return{...t,models:t.models.map(e=>ey({model:e,dbOptions:n}))}},ey=e=>{let{model:t,dbOptions:n}=e;return{...t,fields:function(e){let{model:t,dbOptions:n}=e,a=t.fields.filter(e=>e.primaryKey);return a.length>1?t.fields:0===a.length?[Y({model:t,dbOptions:n}),...t.fields]:t.fields.map(e=>X({field:e,model:t,dbOptions:n}))}({model:t,dbOptions:n})}},eM={name:"sequelize",displayName:()=>"Sequelize",projectType:()=>o.Npm,generate:function(e){var t;let{schema:n,meta:a,dbOptions:o}=e,r=ef({schema:n,dbOptions:o}),l=function(e){let{schema:t,dbOptions:n}=e,a=function(e,t){let n=(0,m.oC)(e.models,e=>e.id);return e.models.flatMap(e=>e.associations.map(e=>(function(e,t,n){let{type:a}=e;if(a.type!=p.Nl.ManyToMany||!(0,p.iy)(a.through))return null;let o=t.get(e.sourceModelId),r=t.get(e.targetModelId);if(!o||!r)return null;let c=z({model:o,association:e,modelById:t,dbOptions:n});if(!c)return null;let s=em({model:o,fk:c,dbOptions:n,primaryKey:!0}),l=(0,y.EL)(),i=(0,p.Lb)({sourceModelId:l,targetModelId:o.id,type:(0,p.zj)()}),u=P({association:e,modelById:t,dbOptions:n});if(!u)return null;let d=em({model:r,fk:u,dbOptions:n,primaryKey:!0}),m=(0,p.Lb)({sourceModelId:l,targetModelId:r.id,type:(0,p.zj)()});return(0,p.o4)({id:l,name:a.through.table,createdAt:o.createdAt,updatedAt:o.updatedAt,fields:[s,d],associations:[i,m]})})(e,n,t))).filter(e=>!!e)}(t,n);return function(e){let t={},n=[];return e.forEach(e=>{let a=(0,y.B9)(e.name),o=t[a];o?t[a]=function(e,t){let n=e.fields.some(e=>e.primaryKey),[,a]=t.fields.reduce((t,a)=>{let o={...a,primaryKey:!1},r=n?o:a;return e.fields.some(e=>(0,y.vQ)(e.name,r.name))?t[0].push(r):t[1].push(r),t},[[],[]]),o=(0,m.V$)([...e.fields,...a],e=>(0,y.Fv)(e.name));return{...e,fields:o}}(o,e):(t[a]=e,n.push(a))}),n.map(e=>t[e])}([...t.models.map(e=>(function(e){let{model:t,schema:n,dbOptions:a}=e;return function(e){let{model:t,schema:n,dbOptions:a}=e,o=function(e){let{model:t,schema:n,dbOptions:a}=e,o=(0,m.oC)(n.models,e=>e.id),r=t.associations.filter(e=>e.type.type===p.Nl.BelongsTo).map(e=>{let n=z({model:t,association:e,modelById:o,dbOptions:a}),r=o.get(e.targetModelId);return r?em({model:r,fk:n,dbOptions:a}):null}).filter(e=>!!e),c=n.models.flatMap(e=>e.associations).filter(e=>(e.type.type===p.Nl.HasOne||e.type.type===p.Nl.HasMany)&&e.targetModelId===t.id).map(e=>{let t=o.get(e.sourceModelId),n=t&&z({model:t,association:e,modelById:o,dbOptions:a});return t&&n?em({model:t,fk:n,dbOptions:a}):null}).filter(e=>!!e),s=t.fields.some(e=>e.primaryKey),l=n.models.flatMap(e=>e.associations).filter(e=>e.type.type===p.Nl.ManyToMany&&e.type.through.type===p.Q$.ThroughModel&&e.type.through.modelId===t.id).flatMap(e=>{let t=!s||void 0,n=o.get(e.sourceModelId),r=n&&z({model:n,association:e,modelById:o,dbOptions:a}),c=n&&r&&em({model:n,fk:r,dbOptions:a,primaryKey:t}),l=o.get(e.targetModelId),i=P({association:e,modelById:o,dbOptions:a});return[c,l&&i&&em({model:l,fk:i,dbOptions:a,primaryKey:t})].filter(e=>!!e)}).filter(e=>!!e);return(0,m.V$)(r.concat(c).concat(l),e=>e.name)}({model:t,schema:n,dbOptions:a}),r=(0,m.V$)(t.fields.map(e=>{let t=o.find(t=>(0,y.s1)(e.name,t.name));return{...e,reference:null==t?void 0:t.reference}}).concat(o),e=>(0,y.Fv)(e.name));return{...t,fields:r}}({model:function(e){let{model:t,dbOptions:n}=e,a=t.fields.concat(Z({model:t,dbOptions:n}));return{...t,fields:(0,m.V$)(a,e=>(0,y.S9)(e.name))}}({model:t,dbOptions:a}),schema:n,dbOptions:a})})({model:e,schema:t,dbOptions:n})),...a])}({schema:r,dbOptions:o}),u=l.reduce(function e(t,n){let a=(0,f.tr)(n.createdAt);return t.get(a)?e(t,{...n,createdAt:(0,f.v8)(n.createdAt,10),updatedAt:(0,f.v8)(n.updatedAt,10)}):t.set(a,n)},new Map),g=r.models.some(e=>e.associations.length>0);return(0,c.PF)((0,y.GL)(r.name),[(0,c.PF)("config",[(0,c.tP)("config.js",function(e){let{schema:t,dbOptions:n}=e;return i(["module.exports = {",i([M({env:"development",schema:t,dbOptions:n,fallback:!0}),M({env:"test",schema:t,dbOptions:n,fallback:!0}),M({env:"production",schema:t,dbOptions:n,fallback:!1})],{depth:2,separator:","}),"}"])}({schema:r,dbOptions:o}))]),(null==o?void 0:o.migrations)&&r.models.length>0?(0,c.PF)("migrations",Array.from(u).sort((e,t)=>e[0]-t[0]).map(e=>{let[t,n]=e;return(0,c.tP)(function(e){let{model:t,dbOptions:n,timestamp:a}=e;return"".concat(a,"-create-").concat(ee({model:t,dbOptions:n}),".js")}({model:n,dbOptions:o,timestamp:t}),function(e){let{model:t,dbOptions:n}=e;return i(["const DataTypes = require('sequelize').DataTypes","","module.exports = {",function(e){let{model:t,dbOptions:n}=e,a=ee({model:t,dbOptions:n});return i(["up: async (queryInterface, Sequelize) => {",i(["await queryInterface.createTable('".concat(a,"', {"),i(t.fields.map(e=>$({field:e,dbOptions:n,define:!0,migration:!0})),{depth:2,separator:","}),"})"],{depth:2}),"},"],{depth:2})}({model:t,dbOptions:n}),function(e){let{model:t,dbOptions:n}=e,a=ee({model:t,dbOptions:n});return i(["down: async (queryInterface, Sequelize) => {",s(2,"await queryInterface.dropTable('".concat(a,"');")),"},"],{depth:2})}({model:t,dbOptions:n}),"};"])}({model:n,dbOptions:o}))}).concat(g?(0,c.tP)((t=function(e){let t=Math.max(0,...e.keys());return t?t+10:(0,f.tr)((0,f.zO)())}(u),"".concat(t,"-add-foreign-keys.js")),function(e){let{dbOptions:t,models:n}=e,a=n.flatMap(e=>(function(e){let{model:t,dbOptions:n}=e,a=ee({model:t,dbOptions:n});return t.fields.map(e=>{if(!e.reference)return null;let t=(0,d.x)(e.name,n.caseStyle);return{sourceTable:a,sourceColumn:t,targetTable:e.reference.table,targetColumn:e.reference.column,name:"".concat(a,"_").concat(t,"_fkey")}}).filter(e=>!!e)})({model:e,dbOptions:t}));return i(["const DataTypes = require('sequelize').DataTypes","","module.exports = {",function(e){let{constraints:t}=e;return i(["up: async (queryInterface, Sequelize) => {",i(t.map(e=>i(["await queryInterface.addConstraint('".concat(e.sourceTable,"', {"),i(function(e){let{sourceColumn:t,targetTable:n,targetColumn:a,name:o}=e;return["fields: ['".concat(t,"'],"),"type: 'foreign key',","name: '".concat(o,"',"),"references: {",i(["table: '".concat(n,"'"),"field: '".concat(a,"'")],{depth:2,separator:","}),"}"]}(e),{depth:2}),"})"])),{depth:2,separator:"\n"}),"},"],{depth:2})}({constraints:a}),function(e){let{constraints:t}=e;return i(["down: async (queryInterface, Sequelize) => {",i(t.map(e=>{let{sourceTable:t,name:n}=e;return i(["await queryInterface.removeConstraint('".concat(t,"', '").concat(n,"')")],{depth:2,separator:"\n"})})),"}"],{depth:2})}({constraints:a}),"};"])}({models:l,dbOptions:o})):[])):null,(0,c.PF)("models",[(0,c.tP)("index.ts",function(e){let{schema:t,dbOptions:n}=e;return i([function(e){let{models:t}=e;return 0===t.length?"import type { Sequelize } from 'sequelize'":"import type { Sequelize, Model } from 'sequelize'"}(t),function(e){let{models:t}=e;return 0===t.length?null:i(t.map(j))}(t),"",function(e){let{models:t}=e;return 0===t.length?null:i(["export {",i(t.map(w),{separator:",",depth:2}),"}"])}(t),"",function(e){let{schema:{models:t},dbOptions:n}=e;if(0===t.length)return"export function initModels(_sequelize: Sequelize) {\n  return {}\n}";let a=(0,m.oC)(t,e=>e.id);return i(["export function initModels(sequelize: Sequelize) {",i(t.map(R),{depth:2}),"",i(t.filter(e=>{let{associations:t}=e;return t.length>0}).map(e=>{var t;return i((t={model:e,modelById:a,dbOptions:n}).model.associations.map(e=>(function(e){let{association:t,model:n,modelById:a,dbOptions:o}=e,r=a.get(t.targetModelId);if(!r)return null;let c=w(n),s=w(r),l=function(e){let{type:t}=e;switch(t.type){case p.Nl.BelongsTo:return"belongsTo";case p.Nl.HasOne:return"hasOne";case p.Nl.HasMany:return"hasMany";case p.Nl.ManyToMany:return"belongsToMany"}}(t),u=function(e){let{model:t,association:n,modelById:a,dbOptions:o}=e;return i([", {",i([function(e,t){let n=t.get(e.targetModelId),a=n&&function(e){let{type:t,alias:n}=e,a=(0,y.eV)(n);switch(t){case p.Nl.HasMany:case p.Nl.ManyToMany:return(0,y.we)(a);case p.Nl.BelongsTo:case p.Nl.HasOne:return(0,y.hP)(a)}}({alias:C({association:e,targetModel:n}),type:e.type.type});return a?"as: '".concat(a,"'"):null}(n,a),n.type.type===p.Nl.ManyToMany?"through: ".concat(function(e){let{type:t,modelById:n}=e;if(t.through.type===p.Q$.ThroughTable)return"'".concat(t.through.table,"'");let a=n.get(t.through.modelId);return a?w(a):null}({type:n.type,modelById:a})):null,function(e){let{model:t,association:n,modelById:a,dbOptions:o}=e,r=z({model:t,association:n,modelById:a,dbOptions:o});return"foreignKey: '".concat(r,"'")}({model:t,association:n,modelById:a,dbOptions:o}),function(e){let{association:t,modelById:n,dbOptions:a}=e,o=P({association:t,modelById:n,dbOptions:a});return o?"otherKey: '".concat(o,"'"):null}({model:t,association:n,modelById:a,dbOptions:o}),function(e){let{model:t,association:n}=e;return(0,p.Cp)(n,t.associations)?"constraints: false":null}({model:t,association:n}),function(e){let{type:t}=e;return t.type===p.Nl.ManyToMany?"onDelete: 'CASCADE'":null}(n)],{depth:2,separator:","}),"}"])}({model:n,association:t,modelById:a,dbOptions:o});return"".concat(c,".").concat(l,"(").concat(s).concat(u,")")})({association:e,...t})))}),{depth:2}),"",i(["return {",i(t.map(w),{depth:2,separator:","}),"}"],{depth:2}),"}"])}({schema:t,dbOptions:n}),""])}({schema:r,dbOptions:o})),...r.models.map(e=>(0,c.tP)(O(e),function(e){let{model:t,schema:n,dbOptions:a}=e,o=function(e){let{associations:t,models:n}=e,a=n.reduce((e,t)=>(e[t.id]=t,e),{});return t.map(e=>({association:e,model:a[e.targetModelId]}))}({associations:t.associations,models:n.models});return function(e){let{model:t,associations:n,dbOptions:a}=e;return i([function(e){let{model:t,associations:n,dbOptions:a}=e;return i([function(e){let{associations:t}=e,n=t.length>0,a=n&&t.some(e=>e.association.type.type===p.Nl.BelongsTo),o=n&&t.some(e=>e.association.type.type===p.Nl.HasMany),r=n&&t.some(e=>e.association.type.type===p.Nl.HasOne),c=n&&t.some(e=>e.association.type.type===p.Nl.ManyToMany);return i(["import {",i([n?"Association,":null,a?et:null,c?eo:null,"CreationOptional,","DataTypes,",o?en:null,r?ea:null,"InferCreationAttributes,","InferAttributes,","Model,",n?"NonAttribute,":null,"Sequelize"],{depth:2}),"} from 'sequelize'"])}({associations:n}),G(t)?function(e){let{sqlDialect:t}=e,n=(0,p.Wp)(),a=K(n,t);return[Q(n,t),"".concat(a,"import { Json } from '../types'")]}(a):null,...(function(e){let{currentModel:t,associations:n}=e;return Object.entries(n.reduce((e,n)=>{let{model:a,association:o}=n;if(o.targetModelId===t.id)return e;let r=(function(e){let{model:t}=e;return[w(t)].filter(e=>!!e)})({association:o,model:a}).reduce((e,t)=>(e[t]=!0,e),e[w(a)]||{});return e[w(a)]=r,e},{})).sort((e,t)=>{let[n]=e,[a]=t;return n.localeCompare(a)}).map(e=>{let[t,n]=e;return[t,Object.keys(n).sort((e,t)=>e.localeCompare(t))]})})({currentModel:t,associations:n}).map(er)])}({model:t,associations:n,dbOptions:a}),"",function(e){let{model:t,associations:n,dbOptions:a}=e,o=w(t),r=n.map(e=>{let{association:t,model:n}=e;return"'".concat(C({association:t,targetModel:n}),"'")}).join(" | "),c=r?"type ".concat(o,"Associations = ").concat(r):null,s=r?", {omit: ".concat(o,"Associations}"):"";return i([r?c:null,r?"":null,"export class ".concat(o," extends Model<"),i(["InferAttributes<".concat(o).concat(s,">,"),"InferCreationAttributes<".concat(o).concat(s,">")],{depth:2}),"> {",i([...t.fields.map(e=>ec(e,a,e.primaryKey))],{depth:2}),i(Z({model:t,dbOptions:a}).map(e=>ec(e,a,!0)),{depth:2}),n.length?"":null,i(n.map(e=>(function(e){let{sourceModel:t,association:{model:n,association:a}}=e,o=w(t),r=w(n),c=C({association:a,targetModel:n}),s=(0,y.hP)((0,y.Ho)(c)),l=(0,y.we)((0,y.Ho)(c)),i=n.fields.filter(e=>e.primaryKey),u=i.length>1?"never":1===i.length?V(i[0].type):V((0,p.XF)());switch(a.type.type){case p.Nl.BelongsTo:return["// ".concat(o," belongsTo ").concat(r).concat(es(a)),"declare ".concat(c,"?: NonAttribute<").concat(r,">"),"declare get".concat(s,": BelongsToGetAssociationMixin<").concat(r,">"),"declare set".concat(s,": BelongsToSetAssociationMixin<").concat(r,", ").concat(u,">"),"declare create".concat(s,": BelongsToCreateAssociationMixin<").concat(r,">"),""].join("\n");case p.Nl.HasMany:{let e=a.foreignKey||(0,y.hP)((0,y.eV)(C({association:a,targetModel:t})))+"Id",i=n.fields.some(t=>(0,y.eV)(t.name)===e)?", '".concat(e,"'"):"";return["// ".concat(o," hasMany ").concat(r).concat(es(a)),"declare ".concat(c,"?: NonAttribute<").concat(r,"[]>"),"declare get".concat(l,": HasManyGetAssociationsMixin<").concat(r,">"),"declare set".concat(l,": HasManySetAssociationsMixin<").concat(r,", ").concat(u,">"),"declare add".concat(s,": HasManyAddAssociationMixin<").concat(r,", ").concat(u,">"),"declare add".concat(l,": HasManyAddAssociationsMixin<").concat(r,", ").concat(u,">"),"declare create".concat(s,": HasManyCreateAssociationMixin<").concat(r).concat(i,">"),"declare remove".concat(s,": HasManyRemoveAssociationMixin<").concat(r,", ").concat(u,">"),"declare remove".concat(l,": HasManyRemoveAssociationsMixin<").concat(r,", ").concat(u,">"),"declare has".concat(s,": HasManyHasAssociationMixin<").concat(r,", ").concat(u,">"),"declare has".concat(l,": HasManyHasAssociationsMixin<").concat(r,", ").concat(u,">"),"declare count".concat(l,": HasManyCountAssociationsMixin"),""].join("\n")}case p.Nl.HasOne:return["// ".concat(o," hasOne ").concat(r).concat(es(a)),"declare ".concat(c,"?: NonAttribute<").concat(r,">"),"declare get".concat(s,": HasOneGetAssociationMixin<").concat(r,">"),"declare set".concat(s,": HasOneSetAssociationMixin<").concat(r,", ").concat(u,">"),"declare create".concat(s,": HasOneCreateAssociationMixin<").concat(r,">"),""].join("\n");case p.Nl.ManyToMany:return["// ".concat(o," belongsToMany ").concat(r).concat(es(a)),"declare ".concat(c,"?: NonAttribute<").concat(r,"[]>"),"declare get".concat(l,": BelongsToManyGetAssociationsMixin<").concat(r,">"),"declare set".concat(l,": BelongsToManySetAssociationsMixin<").concat(r,", ").concat(u,">"),"declare add".concat(s,": BelongsToManyAddAssociationMixin<").concat(r,", ").concat(u,">"),"declare add".concat(l,": BelongsToManyAddAssociationsMixin<").concat(r,", ").concat(u,">"),"declare create".concat(s,": BelongsToManyCreateAssociationMixin<").concat(r,">"),"declare remove".concat(s,": BelongsToManyRemoveAssociationMixin<").concat(r,", ").concat(u,">"),"declare remove".concat(l,": BelongsToManyRemoveAssociationsMixin<").concat(r,", ").concat(u,">"),"declare has".concat(s,": BelongsToManyHasAssociationMixin<").concat(r,", ").concat(u,">"),"declare has".concat(l,": BelongsToManyHasAssociationsMixin<").concat(r,", ").concat(u,">"),"declare count".concat(l,": BelongsToManyCountAssociationsMixin"),""].join("\n")}})({sourceModel:t,association:e})),{depth:2}),n.length?i(["declare static associations: {",i(n.map(e=>(function(e){let{sourceModel:t,association:{model:n,association:a}}=e,o=C({association:a,targetModel:n}),r="Association<".concat(w(t),", ").concat(w(n),">");return"".concat(o,": ").concat(r)})({sourceModel:t,association:e})),{depth:2,separator:","}),"}"],{depth:2}):null,n.length?"":null,i(["static initModel(sequelize: Sequelize): typeof ".concat(o," {"),i(["".concat(o,".init({"),i(t.fields.concat(Z({model:t,dbOptions:a})).map(e=>$({field:e,dbOptions:a})),{depth:2,separator:","}),"}, {",i(["sequelize",function(e){let{dbOptions:{caseStyle:t,nounForm:n},model:a}=e;return n===d.Bb.Singular&&t===d.eB.Snake?"tableName: '".concat((0,y.hP)((0,y.fu)(a.name)),"'"):null}({model:t,dbOptions:a}),t.softDelete?"paranoid: true":null],{depth:2,separator:","}),"})","","return ".concat(o)],{depth:2}),"}"],{depth:2}),"}"])}({model:t,associations:n,dbOptions:a}),""])}({model:t,associations:o,dbOptions:a})}({schema:r,dbOptions:o,model:e})))].sort((e,t)=>(0,c.cQ)(e).localeCompare((0,c.cQ)(t)))),(0,c.tP)(".gitignore",i(["node_modules/","dist","npm-debug.log*","yarn-debug.log*","yarn-error.log*",".npm",".tmp",""])),(0,c.tP)("db.ts",function(e){let{dbOptions:t}=e;return i([U(),"",B({dbOptions:t}),"",v(),""])}({dbOptions:o})),(0,c.tP)("package.json",function(e){let{schema:t,dbOptions:n}=e;return'{\n  "name": "'.concat((0,y.GL)(t.name),'",\n  "version": "0.0.1",\n  "description": "",\n  "main": "server.ts",\n  "scripts": {\n').concat(function(e){let{sqlDialect:t,migrations:n}=e,a=ed.includes(t);return i(['"test": "echo \\"Error: no test specified\\" && exit 1"',a&&n?'"db:up": "echo creating && npm run db:create && echo created && npm run db:migrate && echo migrated"':null,a&&n?'"db:reset": "npm run db:drop && npm run db:up"':null,a?'"db:create": "sequelize db:create"':null,a?'"db:drop": "[[ $NODE_ENV == production ]] && exit 1 || sequelize db:drop"':null,n?'"db:migrate": "sequelize db:migrate"':null,n?'"db:rollback": "sequelize db:migrate:undo"':null,n?'"db:rollback:all": "sequelize db:migrate:undo:all"':null,'"build": "tsc"','"start": "node ./dist/server.js"','"dev": "tsc-watch --onSuccess \\"node ./dist/server.js\\""'],{depth:4,separator:","})}(n),'\n  },\n  "author": "",\n  "license": "ISC",\n  "dependencies": {\n').concat(ei(...el(),...function(e){let{sqlDialect:t}=e;switch(t){case d.t5.MariaDb:return[["mariadb","^3.2.3"]];case d.t5.MsSql:return[["tedious","^17.0.0"]];case d.t5.MySql:return[["mysql2","^3.9.2"]];case d.t5.Postgres:return[["pg","^8.11.3"],["pg-hstore","^2.3.4"]];case d.t5.Sqlite:return[["sqlite3","^5.1.7"]]}}(n)),'\n  },\n  "devDependencies": {\n').concat(ei(["@types/node","^20.11.24"],["@types/validator","^13.11.9"],["sequelize-cli","^6.6.2"],["tsc-watch","^6.0.4"],["typescript","^5.3.3"],...function(e){let{sqlDialect:t}=e;switch(t){case d.t5.MariaDb:return[];case d.t5.MsSql:return[["@types/tedious","^4.0.14"]];case d.t5.MySql:case d.t5.Postgres:return[];case d.t5.Sqlite:return[["@types/sqlite3","^3.1.11"]]}}(n)),"\n  }\n}\n\n")}({schema:r,dbOptions:o})),(0,c.tP)("README.md",function(e){let{schema:t,meta:n,dbOptions:a}=e;return i(["# ".concat(t.name),"This project was generated with [Sequelize UI](https://github.com/tomjschuster/sequelize-ui). The project is a simple [Node.js](https://nodejs.dev/) server with [Sequelize ORM](https://sequelize.org/).","","Be sure to test all code for correctness and to test database migrations in a test environment before deploying to production.","",n?function(e){let{displayName:t,description:n}=e;return i(["## Schema","The Sequelize schema for this project was derived from the ".concat(t," sample database."),"",...(0,m.iD)(n,""),""])}(n):null,"## Running Project","","### Prerequesites","- [Node.js](https://nodejs.dev/)","- ".concat(function(e){switch(e){case d.t5.MariaDb:return"[MariaDB](https://mariadb.com/)";case d.t5.MsSql:return"[SQL Server](https://www.microsoft.com/en-us/sql-server/sql-server-2019)";case d.t5.MySql:return"[MariaDB](https://www.mysql.com/)";case d.t5.Postgres:return"[PostgreSQL](https://www.postgresql.org/)";case d.t5.Sqlite:return"[SQLite](https://www.sqlite.org/index.html)"}}(a.sqlDialect)),"","### Setup","1. Install dependencies: `npm install`","2. Setup database: `npm run db:up`","","### Run","- Local development: `npm run dev`","- Production build: `npm run build && npm start`","","## Bug Reports","Please report any bugs with generated code at [Sequelize UI Issues](https://github.com/tomjschuster/sequelize-ui/issues).",""])}({schema:r,meta:a,dbOptions:o})),(0,c.tP)("server.ts",ep({dbOptions:o})),r.models.some(G)?(0,c.tP)("types.ts",i([i(["export interface JsonMap {[member: string]: string | number | boolean | null | JsonArray | JsonMap }","","export interface JsonArray extends Array<string | number | boolean | null | JsonArray | JsonMap> {}","","export type Json = JsonMap | JsonArray | string | number | boolean | null",""])])):null,(0,c.tP)("tsconfig.json",'{\n  "compilerOptions": {\n    "target": "ES2020",\n    "module": "commonjs",\n    "lib": ["ES2020"],\n    "outDir": "dist",\n    "strict": true,\n    "moduleResolution": "node",\n    "esModuleInterop": true,\n    "allowJs": true,\n    "forceConsistentCasingInFileNames": true\n  }\n}\n')])},defaultFile:e=>"".concat(e.name,"/models/index.ts"),defaultModelFile:(e,t)=>{var n,a;let o=null===(a=t.files.filter(c.IQ).find(e=>"models"===e.name))||void 0===a?void 0:null===(n=a.files)||void 0===n?void 0:n.find(t=>t.name===O(e));return o&&"".concat(t.name,"/models/").concat(o.name)},modelFromPath:(e,t)=>{let n=(0,c.cD)(e);return t.models.find(e=>O(e)===n)}}}}]);